<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"8.0.0-rc.3","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="事务的基本特征原子性（atomicity）：一个事务必须视为一个不可分割的最小工作单元，整个事务中的所有操作要么全部提交成功，要么全部失败回滚，对于一个事务来说，不可能只执行其中的一部分操作，这就是事务的原子性。一致性（consistency）：数据库总数从一个一致性的状态转换到另一个一致性的状态。隔离性（isolation）：一个事务所做的修改在最终提交以前，对其他事务是不可见的。持久性（dur">
<meta property="og:type" content="article">
<meta property="og:title" content="Mysql">
<meta property="og:url" content="http://yoursite.com/2020/08/11/Mysql/index.html">
<meta property="og:site_name" content="Mr">
<meta property="og:description" content="事务的基本特征原子性（atomicity）：一个事务必须视为一个不可分割的最小工作单元，整个事务中的所有操作要么全部提交成功，要么全部失败回滚，对于一个事务来说，不可能只执行其中的一部分操作，这就是事务的原子性。一致性（consistency）：数据库总数从一个一致性的状态转换到另一个一致性的状态。隔离性（isolation）：一个事务所做的修改在最终提交以前，对其他事务是不可见的。持久性（dur">
<meta property="article:published_time" content="2020-08-11T06:23:28.509Z">
<meta property="article:modified_time" content="2020-07-13T12:24:38.192Z">
<meta property="article:author" content="Jun-Gui">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/2020/08/11/Mysql/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>Mysql | Mr</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?fd5e70c0f8bc67c5a280145fd40d6226";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="تشغيل شريط التصفح">
        <span class="toggle-line toggle-line-first"></span>
        <span class="toggle-line toggle-line-middle"></span>
        <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Mr</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>معلومات</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>الوسوم</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>التصنيفات</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>الأرشيفات</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>التقويم</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/11/Mysql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jun-Gui">
      <meta itemprop="description" content="总有疾风起">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Mysql
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">نُشر في</span>

              <time title="أُنشأ: 2020-08-11 14:23:28" itemprop="dateCreated datePublished" datetime="2020-08-11T14:23:28+08:00">2020-08-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">عُدل في</span>
                <time title="عُدل: 2020-07-13 20:24:38" itemprop="dateModified" datetime="2020-07-13T20:24:38+08:00">2020-07-13</time>
              </span>

          <br>
            <span class="post-meta-item" title="عدد الحروف في المقال">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">عدد الحروف في المقال: </span>
              <span>27k</span>
            </span>
            <span class="post-meta-item" title="زمن القراءة">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">زمن القراءة &asymp;</span>
              <span>24 دقائق.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>事务的基本特征原子性（atomicity）：一个事务必须视为一个不可分割的最小工作单元，整个事务中的所有操作要么全部提交成功，要么全部失败回滚，对于一个事务来说，不可能只执行其中的一部分操作，这就是事务的原子性。一致性（consistency）：数据库总数从一个一致性的状态转换到另一个一致性的状态。隔离性（isolation）：一个事务所做的修改在最终提交以前，对其他事务是不可见的。持久性（durability）：一旦事务提交，则其所做的修改就会永久保存到数据库中。此时即使系统崩溃，修改的数据也不会丢失。</p>
<p>事务的隔离级别，mysql默认的隔离级别是什么？读未提交(Read uncommitted)，一个事务可以读取另一个未提交事务的数据，最低级别，任何情况都无法保证。读已提交(Read committed)，一个事务要等另一个事务提交后才能读取数据，可避免脏读的发生。可重复读(Repeatable read)，就是在开始读取数据（事务开启）时，不再允许修改操作，可避免脏读、不可重复读的发生。串行(Serializable)，是最高的事务隔离级别，在该级别下，事务串行化顺序执行，可以避免脏读、不可重复读与幻读。但是这种事务隔离级别效率低下，比较耗数据库性能，一般不使用。Mysql的默认隔离级别是Repeatable read。</p>
<p>说一说脏读、不可重复读、幻读脏读：事务A读取了事务B更新的数据，然后B回滚操作，那么A读取到的数据是脏数据；不可重复读：事务 A 多次读取同一数据，事务 B 在事务A多次读取的过程中，对数据作了更新并提交，导致事务A多次读取同一数据时，结果因此本事务先后两次读到的数据结果会不一致；幻读：幻读解决了不重复读，保证了同一个事务里，查询的结果都是事务开始时的状态（一致性）；</p>
<p>数据表类型有哪些答：MyIASM、InnoDB、HEAP、ISAM、MERGE、DBD以及Gemeni(一般只知道前两者即可)</p>
<p>innodb引擎的4大特性答：插入缓冲(insert buffer)；二次写(double write)；自适应哈希索引(ahi)；预读(read ahead)</p>
<p>InnoDB引擎的行锁是通过加在什么上实现的？答：基于索引；</p>
<p>Mysql中的myisam与innodb的区别，至少五点InooDB支持事务，而MyISAM不支持事务；InnoDB支持行级锁，而MyISAM支持表级锁；InnoDB支持MVCC，而MyISAM不支持；InnoDB支持外键，而MyISAM不支持；InnoDB不支持全文索引，而MyISAM支持；InnoDB不能通过直接拷贝表文件的方法拷贝表到另外一台机器， myisam 支持；InnoDB表支持多种行格式， myisam 不支持；InnoDB是索引组织表， myisam 是堆表；</p>
<p>myisam与innodb select count(*)哪个更快，为什么答：myisam更快，因为myisam内部维护了一个计数器，可以直接调取。</p>
<p>数据库三大范式第一范式：第一范式: 每个列都不可以再拆分. 第二范式: 非主键列完全依赖于主键,而不能是依赖于主键的一部分. 第三范式: 非主键列只依赖于主键,不依赖于其他非主键.</p>
<p>说一说你能想到的sql语句优化，至少五种避免select *，将需要查找的字段列出来；使用连接（join）来代替子查询；拆分大的delete或insert语句；使用limit对查询结果的记录进行限定；用 exists 代替 in 是一个好的选择；用Where子句替换HAVING 子句 因为HAVING 只会在检索出所有记录之后才对结果集进行过滤；不要在 where 子句中的“=”左边进行函数、算术运算或其他表达式运算，否则系统将可能无法正确使用索引尽量避免在where 子句中对字段进行 null 值判断，否则将导致引擎放弃使用索引而进行全表扫描；尽量避免在 where 子句中使用 or 来连接条件，否则将导致引擎放弃使用索引而进行全表扫描；尽量避免在 where 子句中使用!=或&lt;&gt;操作符，否则将引擎放弃使用索引而进行全表扫描；</p>
<p>说一说你能想到的表结构优化，至少五种永远为每张表设置一个ID (所有建表的时候不设置主键的程序猿都应该被辞退)；选择正确的存储引擎 ;使用可存下数据的最小的数据类型，整型 &lt; date,time &lt; char,varchar &lt; blob；使用简单的数据类型，整型比字符处理开销更小，因为字符串的比较更复杂。如，int类型存储时间类型，bigint类型转ip函数；使用合理的字段属性长度，固定长度的表会更快。使用enum、char而不是varchar；尽可能使用not null定义字段(给空字段设置默认值)；尽量少用text;给频繁使用和查询的字段建立合适的索引；</p>
<p>说几个mysql中你常用的函数答：sum、count 、avg、min、max</p>
<p>说几个你除了增删改查之外在mysql中常用的命令答：Explain、describe、show、truncate</p>
<p>说几个除了增删改查之外常用的关键字答：distinct、limit、offset、order by、union、union all、between、group by；</p>
<p>union、union all的区别对重复结果的处理：UNION在进行表链接后会筛选掉重复的记录，Union All不会去除重复记录；对排序的处理：Union将会按照字段的顺序进行排序；UNION ALL只是简单的将两个结果合并后就返回；从效率上说，UNION ALL 要比UNION快很多</p>
<p>varchar(100)和varchar(200)的区别答：varchar(100)最多存放100个字符，varchar(200)最多存放200个字符，varchar(100)和(200)存储hello所占空间一样，但后者在排序时会消耗更多内存，因为order by col采用fixed_length计算col长度(memory引擎也一样)</p>
<p>varchar(20)和int(20)中的20含义一样吗答：不一样，前者表示最多存放20个字符，后者表示最多显示20个字符，但是存储空间还是占4字节存储，存储范围不变；<br>什么是存储过程？用什么来调用？答：存储过程是一个预编译的SQL 语句，优点是允许模块化的设计，就是说只需创建一次，以后在该程序中就可以调用多次。如果某次操作需要执行多次SQL ，使用存储过程比单纯SQL 语句执行要快。可以用一个命令对象来调用存储过程。</p>
<p>什么是触发器？触发器的作用？答：触发器是一中特殊的存储过程，主要是通过事件来触发而被执行的。它可以强化约束，来维护数据的完整性和一致性，可以跟踪数据库内的操作从而不允许未经许可的更新和变化。可以联级运算。如，某表上的触发器上包含对另一个表的数据操作，而该操作又会导致该表触发器被触发。</p>
<p>存储过程与触发器的区别答：触发器与存储过程非常相似，触发器也是SQL语句集，两者唯一的区别是触发器不能用EXECUTE语句调用，而是在用户执行Transact-SQL语句时自动触发（激活）执行。触发器是在一个修改了指定表中的数据时执行的存储过程。通常通过创建触发器来强制实现不同表中的逻辑相关数据的引用完整性和一致性。由于用户不能绕过触发器，所以可以用它来强制实施复杂的业务规则，以确保数据的完整性。触发器不同于存储过程，触发器主要是通过事件执行触发而被执行的，而存储过程可以通过存储过程名称名字而直接调用。当对某一表进行诸如UPDATE、INSERT、DELETE这些操作时，SQLSERVER就会自动执行触发器所定义的SQL语句，从而确保对数据的处理必须符合这些SQL语句所定义的规则。</p>
<p>索引的作用？和它的优点缺点是什么？答：索引就一种特殊的查询表，数据库的搜索引擎可以利用它加速对数据的检索。它很类似与现实生活中书的目录，不需要查询整本书内容就可以找到想要的数据。索引可以是唯一的，创建索引允许指定单个列或者是多个列。缺点是它减慢了数据录入的速度，同时也增加了数据库的尺寸大小。<br>MySQL主要的索引类型普通索引：是最基本的索引，它没有任何限制；唯一索引：索引列的值必须唯一，但允许有空值。如果是组合索引，则列值的组合必须唯一；主键索引：是一种特殊的唯一索引，一个表只能有一个主键，不允许有空值；组合索引：指多个字段上创建的索引，只有在查询条件中使用了创建索引时的第一个字段，索引才会被使用。使用组合索引时遵循最左前缀集合；全文索引：主要用来查找文本中的关键字，而不是直接与索引中的值相比较，mysql中MyISAM支持全文索引而InnoDB不支持；</p>
<p>使用like ‘a%’ 、like’%a’、like’%a%’查询时是否会使用索引答：’a%’会，其他两个不会；</p>
<p>使用索引注意事项索引不会包含有NULL的列，复合索引中只要有一列含有NULL值，那么这一列对于此符合索引就是无效的；使用短索引，对串列进行索引，如果可以就应该指定一个前缀长度；短索引不仅可以提高查询速度而且可以节省磁盘空间和I/O操作；mysql查询只使用一个索引，因此数据库默认排序可以符合要求的情况下不要使用排序操作，尽量不要包含多个列的排序，如果需要最好给这些列建复合索引；注意like，上文已经提到；不要在列上进行运算；不使用NOT IN 、&lt;&gt;、！=操作，但&lt;,&lt;=，=，&gt;,&gt;=,BETWEEN,IN是可以用到索引的；索引要建立在经常进行select操作的字段上；索引要建立在值比较唯一的字段上；对于那些定义为text、image和bit数据类型的列不应该增加索引；在where和join中出现的列需要建立索引；如果where字句的查询条件里使用了函数(如：where DAY(column)=…),mysql将无法使用索引；在join操作中(需要从多个数据表提取数据时)，mysql只有在主键和外键的数据类型相同时才能使用索引，否则及时建立了索引也不会使用；</p>
<p>说一说什么是外键，优缺点答：外键指的是外键约束，目的是保持数据一致性，完整性，控制存储在外键表中的数据。使两张表形成关联，外键只能引用外表中列的值；优点：由数据库自身保证数据一致性，完整性，更可靠，因为程序很难100％保证数据的完整性，而用外键即使在数据库服务器当机或者出现其他问题的时候，也能够最大限度的保证数据的一致性和完整性。有主外键的数据库设计可以增加ER图的可读性，这点在数据库设计时非常重要。外键在一定程度上说明的业务逻辑，会使设计周到具体全面。缺点：可以用触发器或应用程序保证数据的完整性；过分强调或者说使用外键会平添开发难度，导致表过多，更改业务困难，扩展困难等问题；不用外键时数据管理简单，操作方便，性能高（导入导出等操作，在insert, update, delete 数据的时候更快）；</p>
<p>在什么时候你会选择使用外键，为什么答：在我的业务逻辑非常简单，业务一旦确定不会轻易更改，表结构简单，业务量小的时候我会选择使用外键。因为当不符合以上条件的时候，外键会影响业务的扩展和修改，当数据量庞大时，会严重影响增删改查的效率。</p>
<p>什么叫视图？游标是什么？视图是一种虚拟的表，具有和物理表相同的功能；可以对视图进行增，改，查，操作，视图通常是有一个表或者多个表的行或列的子集。对视图的修改不影响基本表。它使得我们获取数据更容易，相比多表查询。游标：是对查询出来的结果集作为一个单元来有效的处理。游标可以定在该单元中的特定行，从结果集的当前行检索一行或多行。可以对结果集当前行做修改。一般不使用游标，但是需要逐条处理数据的时候，游标显得十分重要。</p>
<p>mysql有没有rowid？答：没有，InnoDB如果没有定义主键，内部会生成一个主键编号rowid ，但是无法查询到。在平时InnoDB建表的时候我们最好自己确定主键，防止每次插入数据前数据库会去生成rowid。</p>
<p>mysql怎么在查询时给查出来的数据设置一个自增的序号？set @i=0;SELECT (@i:=@i+1) 别名 FROM table, (SELECT @i:=0) AS 别名 ;</p>
<p>如何使用explain优化sql和索引？explain sql ;table：显示这一行的数据是关于哪张表的；type：这是重要的列，显示连接使用了何种类型。从最好到最差的连接类型为const、eq_reg、ref、range、index和ALL；all: full table scan ;MySQL将遍历全表以找到匹配的行；index ： index scan; index 和 all的区别在于index类型只遍历索引；range：索引范围扫描，对索引的扫描开始于某一点，返回匹配值的行，常见与between ，&lt; ,&gt;等查询；ref：非唯一性索引扫描，返回匹配某个单独值的所有行，常见于使用非唯一索引即唯一索引的非唯一前缀进行查找；eq_ref：唯一性索引扫描，对于每个索引键，表中只有一条记录与之匹配，常用于主键或者唯一索引扫描；const，system：当MySQL对某查询某部分进行优化，并转为一个常量时，使用这些访问类型；如果将主键置于where列表中，MySQL就能将该查询转化为一个常量；possible_keys：显示可能应用在这张表中的索引；如果为空，没有可能的索引；可以为相关的域从WHERE语句中选择一个合适的语句；key： 实际使用的索引；如果为NULL，则没有使用索引；很少的情况下，MySQL会选择优化不足的索引；这种情况下，可以在SELECT语句中使用USE INDEX(indexname)来强制使用一个索引或者用IGNORE INDEX(indexname)来强制MySQL忽略索引key_len：使用的索引的长度；在不损失精确性的情况下，长度越短越好；ref：显示索引的哪一列被使用了，如果可能的话，是一个常数；rows：MySQL认为必须检查的用来返回请求数据的行数；Extra：关于MySQL如何解析查询的额外信息；</p>
<p>1.需要数据库表1.学生表<br>Student(SID,Sname,Sage,Ssex) –SID 学生编号,Sname 学生姓名,Sage 出生年月,Ssex 学生性别</p>
<p>2.课程表<br>Course(CID,Cname,TID) –CID –课程编号,Cname 课程名称,TID 教师编号<br>3.教师表<br>Teacher(TID,Tname) –TID 教师编号,Tname 教师姓名<br>4.成绩表<br>SC(SID,CID,score) –SID 学生编号,CID 课程编号,score 分数</p>
<p>添加测试数据1.学生表<br>create table Student(SID varchar(10),Sname nvarchar(10),Sage datetime,Ssex nvarchar(10));<br>insert into Student values(‘01’ , ‘赵雷’ , ‘1990-01-01’ , ‘男’);<br>insert into Student values(‘02’ , ‘钱电’ , ‘1990-12-21’ , ‘男’);<br>insert into Student values(‘03’ , ‘孙风’ , ‘1990-05-20’ , ‘男’);<br>insert into Student values(‘04’ , ‘李云’ , ‘1990-08-06’ , ‘男’);<br>insert into Student values(‘05’ , ‘周梅’ , ‘1991-12-01’ , ‘女’);<br>insert into Student values(‘06’ , ‘吴兰’ , ‘1992-03-01’ , ‘女’);<br>insert into Student values(‘07’ , ‘郑竹’ , ‘1989-07-01’ , ‘女’);<br>insert into Student values(‘08’ , ‘王菊’ , ‘1990-01-20’ , ‘女’);</p>
<p>2.课程表<br>create table Course(CID varchar(10),Cname nvarchar(10),TID varchar(10));<br>insert into Course values(‘01’ , ‘语文’ , ‘02’);<br>insert into Course values(‘02’ , ‘数学’ , ‘01’);<br>insert into Course values(‘03’ , ‘英语’ , ‘03’);</p>
<p>3.教师表<br>create table Teacher(TID varchar(10),Tname nvarchar(10));<br>insert into Teacher values(‘01’ , ‘张三’);<br>insert into Teacher values(‘02’ , ‘李四’);<br>insert into Teacher values(‘03’ , ‘王五’);</p>
<p>4.成绩表<br>create table SC(SID varchar(10),CID varchar(10),score decimal(18,1));<br>insert into SC values(‘01’ , ‘01’ , 80);<br>insert into SC values(‘01’ , ‘02’ , 90);<br>insert into SC values(‘01’ , ‘03’ , 99);<br>insert into SC values(‘02’ , ‘01’ , 70);<br>insert into SC values(‘02’ , ‘02’ , 60);<br>insert into SC values(‘02’ , ‘03’ , 80);<br>insert into SC values(‘03’ , ‘01’ , 80);<br>insert into SC values(‘03’ , ‘02’ , 80);<br>insert into SC values(‘03’ , ‘03’ , 80);<br>insert into SC values(‘04’ , ‘01’ , 50);<br>insert into SC values(‘04’ , ‘02’ , 30);<br>insert into SC values(‘04’ , ‘03’ , 20);<br>insert into SC values(‘05’ , ‘01’ , 76);<br>insert into SC values(‘05’ , ‘02’ , 87);<br>insert into SC values(‘06’ , ‘01’ , 31);<br>insert into SC values(‘06’ , ‘03’ , 34);<br>insert into SC values(‘07’ , ‘02’ , 89);<br>insert into SC values(‘07’ , ‘03’ , 98);</p>
<p>–1、查询”01”课程比”02”课程成绩高的学生的信息及课程分数</p>
<p>–1.1、查询同时存在”01”课程和”02”课程的情况<br>select a.* , b.score 课程01的分数,c.score 课程02的分数 from Student a , SC b , SC c<br>where a.SID = b.SID and a.SID = c.SID and b.CID = ‘01’ and c.CID = ‘02’ and b.score &gt; c.score</p>
<p>–1.2、查询同时存在”01”课程和”02”课程的情况和存在”01”课程但可能不存在”02”课程的情况(不存在时显示为null)(以下存在相同内容时不再解释)<br>select a.* , b.score 课程01的分数,c.score 课程02的分数 from Student a<br>left join SC b on a.SID = b.SID and b.CID = ‘01’<br>left join SC c on a.SID = c.SID and c.CID = ‘02’<br>where b.score &gt; isnull(c.score)</p>
<p>–2、查询”01”课程比”02”课程成绩低的学生的信息及课程分数</p>
<p>–2.1、查询同时存在”01”课程和”02”课程的情况<br>select a.* , b.score 课程01的分数 ,c.score 课程02的分数 from Student a , SC b , SC c<br>where a.SID = b.SID and a.SID = c.SID and b.CID = ‘01’ and c.CID = ‘02’ and b.score &lt; c.score</p>
<p>–2.2、查询同时存在”01”课程和”02”课程的情况和不存在”01”课程但存在”02”课程的情况<br>select a.* , b.score 课程01的分数 ,c.score 课程02的分数 from Student a<br>left join SC b on a.SID = b.SID and b.CID = ‘01’<br>left join SC c on a.SID = c.SID and c.CID = ‘02’<br>where isnull(b.score,0) &lt; c.score</p>
<p>–3、查询平均成绩大于等于60分的同学的学生编号和学生姓名和平均成绩<br>select a.SID , a.Sname , cast(avg(b.score) as decimal(18,2)) avg_score<br>from Student a , sc b<br>where a.SID = b.SID<br>group by a.SID , a.Sname<br>having cast(avg(b.score) as decimal(18,2)) &gt;= 60<br>order by a.SID</p>
<p>–4、查询平均成绩小于60分的同学的学生编号和学生姓名和平均成绩</p>
<p>–4.1、查询在sc表存在成绩的学生信息的SQL语句。<br>select a.SID , a.Sname , cast(avg(b.score) as decimal(18,2)) avg_score<br>from Student a , sc b<br>where a.SID = b.SID<br>group by a.SID , a.Sname<br>having cast(avg(b.score) as decimal(18,2)) &lt; 60<br>order by a.SID</p>
<p>–4.2、查询在sc表中不存在成绩的学生信息的SQL语句。<br>select a.SID , a.Sname , isnull(cast(avg(b.score) as decimal(18,2)),0) avg_score<br>from Student a left join sc b<br>on a.SID = b.SID<br>group by a.SID , a.Sname<br>having isnull(cast(avg(b.score) as decimal(18,2)),0) &lt; 60<br>order by a.SID</p>
<p>–5、查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩</p>
<p>–5.1、查询所有有成绩的SQL。<br>select a.SID 学生编号 , a.Sname 学生姓名 , count(b.CID) 选课总数, sum(score) 所有课程的总成绩<br>from Student a , SC b<br>where a.SID = b.SID<br>group by a.SID,a.Sname<br>order by a.SID</p>
<p>–5.2、查询所有(包括有成绩和无成绩)的SQL。<br>select a.SID 学生编号 , a.Sname 学生姓名 , count(b.CID) 选课总数, sum(score) 所有课程的总成绩<br>from Student a left join SC b<br>on a.SID = b.SID<br>group by a.SID,a.Sname<br>order by a.SID</p>
<p>–6、查询”李”姓老师的数量<br>–方法1<br>select count(Tname) 李姓老师的数量 from Teacher where Tname like ‘李%’<br>–方法2<br>select count(Tname) 李姓老师的数量 from Teacher where left(Tname,1) = ‘李’</p>
<p>–7、查询学过”张三”老师授课的同学的信息<br>select distinct Student.* from Student , SC , Course , Teacher<br>where Student.SID = SC.SID and SC.CID = Course.CID and Course.TID = Teacher.TID and Teacher.Tname = ‘张三’<br>order by Student.SID</p>
<p>–8、查询没学过”张三”老师授课的同学的信息<br>select m.* from Student m where SID not in (select distinct SC.SID from SC , Course , Teacher where SC.CID = Course.CID and Course.TID = Teacher.TID and Teacher.Tname = ‘张三’) order by m.SID</p>
<p>–9、查询学过编号为”01”并且也学过编号为”02”的课程的同学的信息<br>–方法1<br>select Student.* from Student , SC where Student.SID = SC.SID and SC.CID = ‘01’ and exists (Select 1 from SC SC_2 where SC_2.SID = SC.SID and SC_2.CID = ‘02’) order by Student.SID<br>–方法2<br>select Student.* from Student , SC where Student.SID = SC.SID and SC.CID = ‘02’ and exists (Select 1 from SC SC_2 where SC_2.SID = SC.SID and SC_2.CID = ‘01’) order by Student.SID<br>–方法3<br>select m.* from Student m where SID in<br>(<br>select SID from<br>(<br>select distinct SID from SC where CID = ‘01’</p>
<p>union all</p>
<p>select distinct SID from SC where CID = ‘02’</p>
<p>) t group by SID having count(1) = 2</p>
<p>)</p>
<p>order by m.SID</p>
<p>–10、查询学过编号为”01”但是没有学过编号为”02”的课程的同学的信息</p>
<p>–方法1</p>
<p>select Student.* from Student , SC where Student.SID = SC.SID and SC.CID = ‘01’ and not exists (Select 1 from SC SC_2 where SC_2.SID = SC.SID and SC_2.CID = ‘02’) order by Student.SID</p>
<p>–方法2<br>select Student.* from Student , SC where Student.SID = SC.SID and SC.CID = ‘01’ and Student.SID not in (Select SC_2.SID from SC SC_2 where SC_2.SID = SC.SID and SC_2.CID = ‘02’) order by Student.SID</p>
<p>–11、查询没有学全所有课程的同学的信息<br>–11.1、<br>select Student.*<br>from Student , SC<br>where Student.SID = SC.SID<br>group by Student.SID , Student.Sname , Student.Sage , Student.Ssex having count(CID) &lt; (select count(CID) from Course)</p>
<p>–11.2<br>select Student.*<br>from Student left join SC<br>on Student.SID = SC.SID<br>group by Student.SID , Student.Sname , Student.Sage , Student.Ssex having count(CID) &lt; (select count(CID) from Course)</p>
<p>–12、查询至少有一门课与学号为”01”的同学所学相同的同学的信息<br>select distinct Student.* from Student , SC where Student.SID = SC.SID and SC.CID in (select CID from SC where SID = ‘01’) and Student.SID &lt;&gt; ‘01’</p>
<p>–13、查询和”01”号的同学学习的课程完全相同的其他同学的信息<br>select Student.* from Student where SID in<br>(select distinct SC.SID from SC where SID &lt;&gt; ‘01’ and SC.CID in (select distinct CID from SC where SID = ‘01’)<br>group by SC.SID having count(1) = (select count(1) from SC where SID=’01’))</p>
<p>–14、查询没学过”张三”老师讲授的任一门课程的学生姓名<br>select student.* from student where student.SID not in<br>(select distinct sc.SID from sc , course , teacher where sc.CID = course.CID and course.TID = teacher.TID and teacher.tname = ‘张三’)<br>order by student.SID</p>
<p>–15、查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩<br>select student.SID , student.sname , cast(avg(score) as decimal(18,2)) avg_score from student , sc<br>where student.SID = SC.SID and student.SID in (select SID from SC where score &lt; 60 group by SID having count(1) &gt;= 2)<br>group by student.SID , student.sname</p>
<p>–16、检索”01”课程分数小于60，按分数降序排列的学生信息<br>select student.* , sc.CID , sc.score from student , sc<br>where student.SID = SC.SID and sc.score &lt; 60 and sc.CID = ‘01’<br>order by sc.score desc</p>
<p>–17、按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩–17.1 SQL 2000 静态<br>select a.SID 学生编号 , a.Sname 学生姓名 ,<br>max(case c.Cname when ‘语文’ then b.score else null end) 语文 ,<br>max(case c.Cname when ‘数学’ then b.score else null end) 数学 ,<br>max(case c.Cname when ‘英语’ then b.score else null end) 英语 ,<br>cast(avg(b.score) as decimal(18,2)) 平均分<br>from Student a<br>left join SC b on a.SID = b.SID<br>left join Course c on b.CID = c.CID<br>group by a.SID , a.Sname<br>order by 平均分 desc</p>
<p>–17.2 SQL 2000 动态<br>declare @sql nvarchar(4000)<br>set @sql = ‘select a.SID ‘ + ‘学生编号’ + ‘ , a.Sname ‘ + ‘学生姓名’<br>select @sql = @sql + ‘,max(case c.Cname when ‘’’+Cname+’’’ then b.score else null end) ‘+Cname+’ ‘<br>from (select distinct Cname from Course) as t<br>set @sql = @sql + ‘ , cast(avg(b.score) as decimal(18,2)) ‘ + ‘平均分’ + ‘ from Student a left join SC b on a.SID = b.SID left join Course c on b.CID = c.CID<br>group by a.SID , a.Sname order by ‘ + ‘平均分’ + ‘ desc’<br>exec(@sql)</p>
<p>–18、查询各科成绩最高分、最低分和平均分：以如下形式显示：课程ID，课程name，最高分，最低分，平均分，及格率，中等率，优良率，优秀率<br>–及格为&gt;=60，中等为：70-80，优良为：80-90，优秀为：&gt;=90</p>
<p>–方法1<br>select m.CID 课程编号 , m.Cname 课程名称 ,<br>max(n.score) 最高分 ,<br>min(n.score) 最低分 ,<br>cast(avg(n.score) as decimal(18,2)) 平均分 ,<br>cast((select count(1) from SC where CID = m.CID and score &gt;= 60)<em>100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 及格率 ,<br>cast((select count(1) from SC where CID = m.CID and score &gt;= 70 and score &lt; 80 )</em>100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 中等率 ,<br>cast((select count(1) from SC where CID = m.CID and score &gt;= 80 and score &lt; 90 )<em>100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 优良率 ,<br>cast((select count(1) from SC where CID = m.CID and score &gt;= 90)</em>100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 优秀率<br>from Course m , SC n<br>where m.CID = n.CID<br>group by m.CID , m.Cname<br>order by m.CID</p>
<p>–方法2<br>select m.CID 课程编号 , m.Cname 课程名称 ,<br>(select max(score) from SC where CID = m.CID) 最高分 ,<br>(select min(score) from SC where CID = m.CID) 最低分 ,<br>(select cast(avg(score) as decimal(18,2)) from SC where CID = m.CID) 平均分 ,<br>cast((select count(1) from SC where CID = m.CID and score &gt;= 60)<em>100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 及格率,<br>cast((select count(1) from SC where CID = m.CID and score &gt;= 70 and score &lt; 80 )</em>100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 中等率 ,<br>cast((select count(1) from SC where CID = m.CID and score &gt;= 80 and score &lt; 90 )<em>100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 优良率 ,<br>cast((select count(1) from SC where CID = m.CID and score &gt;= 90)</em>100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 优秀率<br>from Course m<br>order by m.CID</p>
<p>–19、按各科成绩进行排序，并显示排名–19.1 sql 2000用子查询完成</p>
<p>–Score重复时保留名次空缺<br>select t.* , px = (select count(1) from SC where CID = t.CID and score &gt; t.score) + 1 from sc t order by t.cid , px</p>
<p>–Score重复时合并名次<br>select t.* , px = (select count(distinct score) from SC where CID = t.CID and score &gt;= t.score) from sc t order by t.cid , px</p>
<p>–19.2 sql 2005用rank,DENSE_RANK完成</p>
<p>–Score重复时保留名次空缺(rank完成)<br>select t.* , px = rank() over(partition by cid order by score desc) from sc t order by t.CID , px</p>
<p>–Score重复时合并名次(DENSE_RANK完成)<br>select t.* , px = DENSE_RANK() over(partition by cid order by score desc) from sc t order by t.CID , px</p>
<p>–20、查询学生的总成绩并进行排名–20.1 查询学生的总成绩<br>select m.SID 学生编号 ,<br>m.Sname 学生姓名 ,<br>isnull(sum(score),0) 总成绩<br>from Student m left join SC n on m.SID = n.SID<br>group by m.SID , m.Sname<br>order by 总成绩 desc</p>
<p>–20.2 查询学生的总成绩并进行排名，sql 2000用子查询完成，分总分重复时保留名次空缺和不保留名次空缺两种。<br>select t1.* , px = (select count(1) from<br>(<br>select m.SID 学生编号 ,<br>m.Sname 学生姓名 ,<br>isnull(sum(score),0) 总成绩<br>from Student m left join SC n on m.SID = n.SID<br>group by m.SID , m.Sname<br>) t2 where 总成绩 &gt; t1.总成绩) + 1 from<br>(<br>select m.SID 学生编号 ,<br>m.Sname 学生姓名 ,<br>isnull(sum(score),0) 总成绩<br>from Student m left join SC n on m.SID = n.SID<br>group by m.SID , m.Sname<br>) t1<br>order by px<br>select t1.* , px = (select count(distinct 总成绩) from<br>(<br>select m.SID 学生编号 ,<br>m.Sname 学生姓名 ,<br>isnull(sum(score),0) 总成绩<br>from Student m left join SC n on m.SID = n.SID<br>group by m.SID , m.Sname<br>) t2 where 总成绩 &gt;= t1.总成绩) from<br>(<br>select m.SID 学生编号 ,<br>m.Sname 学生姓名 ,<br>isnull(sum(score),0) 总成绩<br>from Student m left join SC n on m.SID = n.SID<br>group by m.SID , m.Sname<br>) t1<br>order by px</p>
<p>–20.3 查询学生的总成绩并进行排名，sql 2005用rank,DENSE_RANK完成，分总分重复时保留名次空缺和不保留名次空缺两种。<br>select t.* , px = rank() over(order by 总成绩 desc) from<br>(<br>select m.SID 学生编号 ,<br>m.Sname 学生姓名 ,<br>isnull(sum(score),0) 总成绩<br>from Student m left join SC n on m.SID = n.SID<br>group by m.SID , m.Sname<br>) t<br>order by px<br>select t.* , px = DENSE_RANK() over(order by 总成绩 desc) from<br>(<br>select m.SID 学生编号 ,<br>m.Sname 学生姓名 ,<br>isnull(sum(score),0) 总成绩<br>from Student m left join SC n on m.SID = n.SID<br>group by m.SID , m.Sname<br>) t<br>order by px</p>
<p>–21、查询不同老师所教不同课程平均分从高到低显示<br>select m.TID , m.Tname , cast(avg(o.score) as decimal(18,2)) avg_score<br>from Teacher m , Course n , SC o<br>where m.TID = n.TID and n.CID = o.CID<br>group by m.TID , m.Tname<br>order by avg_score desc</p>
<p>–22、查询所有课程的成绩第2名到第3名的学生信息及该课程成绩–22.1 sql 2000用子查询完成<br>–Score重复时保留名次空缺<br>select * from (select t.* , px = (select count(1) from SC where CID = t.CID and score &gt; t.score) + 1 from sc t) m where px between 2 and 3 order by m.cid , m.px</p>
<p>–Score重复时合并名次<br>select * from (select t.* , px = (select count(distinct score) from SC where CID = t.CID and score &gt;= t.score) from sc t) m where px between 2 and 3 order by m.cid , m.px</p>
<p>–22.2 sql 2005用rank,DENSE_RANK完成</p>
<p>–Score重复时保留名次空缺(rank完成)<br>select * from (select t.* , px = rank() over(partition by cid order by score desc) from sc t) m where px between 2 and 3 order by m.CID , m.px</p>
<p>–Score重复时合并名次(DENSE_RANK完成)<br>select * from (select t.* , px = DENSE_RANK() over(partition by cid order by score desc) from sc t) m where px between 2 and 3 order by m.CID , m.px</p>
<p>–23、统计各科成绩各分数段人数：课程编号,课程名称, 100-85 , 85-70 , 70-60 , 0-60 及所占百分比 –23.1 统计各科成绩各分数段人数：课程编号,课程名称, 100-85 , 85-70 , 70-60 , 0-60</p>
<p>–横向显示<br>select Course.CID 课程编号 , Cname as 课程名称 ,<br>sum(case when score &gt;= 85 then 1 else 0 end) 85-100 ,<br>sum(case when score &gt;= 70 and score &lt; 85 then 1 else 0 end) 70-85 ,<br>sum(case when score &gt;= 60 and score &lt; 70 then 1 else 0 end) 60-70 ,<br>sum(case when score &lt; 60 then 1 else 0 end) 0-60<br>from sc , Course<br>where SC.CID = Course.CID<br>group by Course.CID , Course.Cname<br>order by Course.CID</p>
<p>–纵向显示1(显示存在的分数段)<br>select m.CID 课程编号 , m.Cname 课程名称 , 分数段 = (<br>case when n.score &gt;= 85 then ‘85-100’<br>when n.score &gt;= 70 and n.score &lt; 85 then ‘70-85’<br>when n.score &gt;= 60 and n.score &lt; 70 then ‘60-70’<br>else ‘0-60’<br>end) ,<br>count(1) 数量<br>from Course m , sc n<br>where m.CID = n.CID<br>group by m.CID , m.Cname , (<br>case when n.score &gt;= 85 then ‘85-100’<br>when n.score &gt;= 70 and n.score &lt; 85 then ‘70-85’<br>when n.score &gt;= 60 and n.score &lt; 70 then ‘60-70’<br>else ‘0-60’<br>end)<br>order by m.CID , m.Cname , 分数段</p>
<p>–纵向显示2(显示存在的分数段，不存在的分数段用0显示)</p>
<p>select m.CID 课程编号 , m.Cname 课程名称 , 分数段 = (</p>
<p>case when n.score &gt;= 85 then ‘85-100’</p>
<p>when n.score &gt;= 70 and n.score &lt; 85 then ‘70-85’</p>
<p>when n.score &gt;= 60 and n.score &lt; 70 then ‘60-70’</p>
<p>else ‘0-60’</p>
<p>end) ,</p>
<p>count(1) 数量</p>
<p>from Course m , sc n</p>
<p>where m.CID = n.CID</p>
<p>group by all m.CID , m.Cname , (</p>
<p>case when n.score &gt;= 85 then ‘85-100’</p>
<p>when n.score &gt;= 70 and n.score &lt; 85 then ‘70-85’</p>
<p>when n.score &gt;= 60 and n.score &lt; 70 then ‘60-70’</p>
<p>else ‘0-60’</p>
<p>end)</p>
<p>order by m.CID , m.Cname , 分数段</p>
<p>–23.2 统计各科成绩各分数段人数：课程编号,课程名称, 100-85 , 85-70 , 70-60 , &lt;60 及所占百分比</p>
<p>–横向显示</p>
<p>select m.CID 课程编号, m.Cname 课程名称,</p>
<p>(select count(1) from SC where CID = m.CID and score &lt; 60) 0-60 ,</p>
<p>cast((select count(1) from SC where CID = m.CID and score &lt; 60)*100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 百分比 ,</p>
<p>(select count(1) from SC where CID = m.CID and score &gt;= 60 and score &lt; 70) 60-70 ,</p>
<p>cast((select count(1) from SC where CID = m.CID and score &gt;= 60 and score &lt; 70)*100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 百分比 ,</p>
<p>(select count(1) from SC where CID = m.CID and score &gt;= 70 and score &lt; 85) 70-85 ,</p>
<p>cast((select count(1) from SC where CID = m.CID and score &gt;= 70 and score &lt; 85)*100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 百分比 ,</p>
<p>(select count(1) from SC where CID = m.CID and score &gt;= 85) 85-100 ,</p>
<p>cast((select count(1) from SC where CID = m.CID and score &gt;= 85)*100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 百分比</p>
<p>from Course m</p>
<p>order by m.CID</p>
<p>–纵向显示1(显示存在的分数段)</p>
<p>select m.CID 课程编号 , m.Cname 课程名称 , 分数段 = (</p>
<p>case when n.score &gt;= 85 then ‘85-100’</p>
<p>when n.score &gt;= 70 and n.score &lt; 85 then ‘70-85’</p>
<p>when n.score &gt;= 60 and n.score &lt; 70 then ‘60-70’</p>
<p>else ‘0-60’</p>
<p>end) ,</p>
<p>count(1) 数量 ,</p>
<p>cast(count(1) * 100.0 / (select count(1) from sc where CID = m.CID) as decimal(18,2)) 百分比</p>
<p>from Course m , sc n</p>
<p>where m.CID = n.CID</p>
<p>group by m.CID , m.Cname , (</p>
<p>case when n.score &gt;= 85 then ‘85-100’</p>
<p>when n.score &gt;= 70 and n.score &lt; 85 then ‘70-85’</p>
<p>when n.score &gt;= 60 and n.score &lt; 70 then ‘60-70’</p>
<p>else ‘0-60’</p>
<p>end)</p>
<p>order by m.CID , m.Cname , 分数段</p>
<p>–纵向显示2(显示存在的分数段，不存在的分数段用0显示)</p>
<p>select m.CID 课程编号 , m.Cname 课程名称 , 分数段 = (</p>
<p>case when n.score &gt;= 85 then ‘85-100’</p>
<p>when n.score &gt;= 70 and n.score &lt; 85 then ‘70-85’</p>
<p>when n.score &gt;= 60 and n.score &lt; 70 then ‘60-70’</p>
<p>else ‘0-60’</p>
<p>end) ,</p>
<p>count(1) 数量 ,</p>
<p>cast(count(1) * 100.0 / (select count(1) from sc where CID = m.CID) as decimal(18,2)) 百分比</p>
<p>from Course m , sc n</p>
<p>where m.CID = n.CID</p>
<p>group by all m.CID , m.Cname , (</p>
<p>case when n.score &gt;= 85 then ‘85-100’</p>
<p>when n.score &gt;= 70 and n.score &lt; 85 then ‘70-85’</p>
<p>when n.score &gt;= 60 and n.score &lt; 70 then ‘60-70’</p>
<p>else ‘0-60’</p>
<p>end)</p>
<p>order by m.CID , m.Cname , 分数段</p>
<p>–24、查询学生平均成绩及其名次–24.1 查询学生的平均成绩并进行排名，sql 2000用子查询完成，分平均成绩重复时保留名次空缺和不保留名次空缺两种。</p>
<p>select t1.* , px = (select count(1) from</p>
<p>(</p>
<p>select m.SID 学生编号 ,</p>
<p>m.Sname 学生姓名 ,</p>
<p>isnull(cast(avg(score) as decimal(18,2)),0) 平均成绩</p>
<p>from Student m left join SC n on m.SID = n.SID</p>
<p>group by m.SID , m.Sname</p>
<p>) t2 where 平均成绩 &gt; t1.平均成绩) + 1 from</p>
<p>(</p>
<p>select m.SID 学生编号 ,</p>
<p>m.Sname 学生姓名 ,</p>
<p>isnull(cast(avg(score) as decimal(18,2)),0) 平均成绩</p>
<p>from Student m left join SC n on m.SID = n.SID</p>
<p>group by m.SID , m.Sname</p>
<p>) t1</p>
<p>order by px</p>
<p>select t1.* , px = (select count(distinct 平均成绩) from</p>
<p>(</p>
<p>select m.SID 学生编号 ,</p>
<p>m.Sname 学生姓名 ,</p>
<p>isnull(cast(avg(score) as decimal(18,2)),0) 平均成绩</p>
<p>from Student m left join SC n on m.SID = n.SID</p>
<p>group by m.SID , m.Sname</p>
<p>) t2 where 平均成绩 &gt;= t1.平均成绩) from</p>
<p>(</p>
<p>select m.SID 学生编号 ,</p>
<p>m.Sname 学生姓名 ,</p>
<p>isnull(cast(avg(score) as decimal(18,2)),0) 平均成绩</p>
<p>from Student m left join SC n on m.SID = n.SID</p>
<p>group by m.SID , m.Sname</p>
<p>) t1</p>
<p>order by px</p>
<p>–24.2 查询学生的平均成绩并进行排名，sql 2005用rank,DENSE_RANK完成，分平均成绩重复时保留名次空缺和不保留名次空缺两种。</p>
<p>select t.* , px = rank() over(order by 平均成绩 desc) from</p>
<p>(</p>
<p>select m.SID 学生编号 ,</p>
<p>m.Sname 学生姓名 ,</p>
<p>isnull(cast(avg(score) as decimal(18,2)),0) 平均成绩</p>
<p>from Student m left join SC n on m.SID = n.SID<br>group by m.SID , m.Sname<br>) t<br>order by px<br>select t.* , px = DENSE_RANK() over(order by 平均成绩 desc) from<br>(<br>select m.SID 学生编号 ,<br>m.Sname 学生姓名 ,<br>isnull(cast(avg(score) as decimal(18,2)),0) 平均成绩<br>from Student m left join SC n on m.SID = n.SID<br>group by m.SID , m.Sname<br>) t<br>order by px</p>
<p>–25、查询各科成绩前三名的记录–25.1 分数重复时保留名次空缺<br>select m.* , n.CID , n.score from Student m, SC n where m.SID = n.SID and n.score in<br>(select top 3 score from sc where CID = n.CID order by score desc) order by n.CID , n.score desc</p>
<p>–25.2 分数重复时不保留名次空缺，合并名次</p>
<p>–sql 2000用子查询实现<br>select * from (select t.* , px = (select count(distinct score) from SC where CID = t.CID and score &gt;= t.score) from sc t) m where px between 1 and 3 order by m.Cid , m.px</p>
<p>–sql 2005用DENSE_RANK实现<br>select * from (select t.* , px = DENSE_RANK() over(partition by Cid order by score desc) from sc t) m where px between 1 and 3 order by m.CID , m.px</p>
<p>–26、查询每门课程被选修的学生数<br>select Cid , count(SID) 学生数 from sc group by CID</p>
<p>–27、查询出只有两门课程的全部学生的学号和姓名<br>select Student.SID , Student.Sname<br>from Student , SC<br>where Student.SID = SC.SID<br>group by Student.SID , Student.Sname<br>having count(SC.CID) = 2<br>order by Student.SID</p>
<p>–28、查询男生、女生人数<br>select count(Ssex) as 男生人数 from Student where Ssex = N’男’<br>select count(Ssex) as 女生人数 from Student where Ssex = N’女’<br>select sum(case when Ssex = N’男’ then 1 else 0 end) 男生人数 ,sum(case when Ssex = N’女’ then 1 else 0 end) 女生人数 from student<br>select case when Ssex = N’男’ then N’男生人数’ else N’女生人数’ end 男女情况 , count(1) 人数 from student group by case when Ssex = N’男’ then N’男生人数’ else N’女生人数’ end</p>
<p>–29、查询名字中含有”风”字的学生信息<br>select * from student where sname like N’%风%’<br>select * from student where charindex(N’风’ , sname) &gt; 0</p>
<p>–30、查询同名同性学生名单，并统计同名人数<br>select Sname 学生姓名 , count(<em>) 人数 from Student group by Sname having count(</em>) &gt; 1</p>
<p>–31、查询1990年出生的学生名单(注：Student表中Sage列的类型是datetime)<br>select * from Student where year(sage) = 1990<br>select * from Student where datediff(yy,sage,’1990-01-01’) = 0<br>select * from Student where datepart(yy,sage) = 1990<br>select * from Student where convert(varchar(4),sage,120) = ‘1990’</p>
<p>–32、查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同时，按课程编号升序排列<br>select m.CID , m.Cname , cast(avg(n.score) as decimal(18,2)) avg_score<br>from Course m, SC n<br>where m.CID = n.CID<br>group by m.CID , m.Cname<br>order by avg_score desc, m.CID asc</p>
<p>–33、查询平均成绩大于等于85的所有学生的学号、姓名和平均成绩<br>select a.SID , a.Sname , cast(avg(b.score) as decimal(18,2)) avg_score<br>from Student a , sc b<br>where a.SID = b.SID<br>group by a.SID , a.Sname<br>having cast(avg(b.score) as decimal(18,2)) &gt;= 85<br>order by a.SID</p>
<p>–34、查询课程名称为”数学”，且分数低于60的学生姓名和分数<br>select sname , score<br>from Student , SC , Course<br>where SC.SID = Student.SID and SC.CID = Course.CID and Course.Cname = N’数学’ and score &lt; 60</p>
<p>–35、查询所有学生的课程及分数情况<br>select Student.* , Course.Cname , SC.CID , SC.score<br>from Student, SC , Course<br>where Student.SID = SC.SID and SC.CID = Course.CID<br>order by Student.SID , SC.CID</p>
<p>–36、查询任何一门课程成绩在70分以上的姓名、课程名称和分数<br>select Student.* , Course.Cname , SC.CID , SC.score<br>from Student, SC , Course<br>where Student.SID = SC.SID and SC.CID = Course.CID and SC.score &gt;= 70<br>order by Student.SID , SC.CID</p>
<p>–37、查询不及格的课程<br>select Student.* , Course.Cname , SC.CID , SC.score<br>from Student, SC , Course<br>where Student.SID = SC.SID and SC.CID = Course.CID and SC.score &lt; 60<br>order by Student.SID , SC.CID</p>
<p>–38、查询课程编号为01且课程成绩在80分以上的学生的学号和姓名<br>select Student.* , Course.Cname , SC.CID , SC.score<br>from Student, SC , Course<br>where Student.SID = SC.SID and SC.CID = Course.CID and SC.CID = ‘01’ and SC.score &gt;= 80<br>order by Student.SID , SC.CID</p>
<p>–39、求每门课程的学生人数<br>select Course.CID , Course.Cname , count(*) 学生人数<br>from Course , SC<br>where Course.CID = SC.CID<br>group by Course.CID , Course.Cname<br>order by Course.CID , Course.Cname</p>
<p>–40、查询选修”张三”老师所授课程的学生中，成绩最高的学生信息及其成绩–40.1 当最高分只有一个时<br>select top 1 Student.* , Course.Cname , SC.CID , SC.score<br>from Student, SC , Course , Teacher<br>where Student.SID = SC.SID and SC.CID = Course.CID and Course.TID = Teacher.TID and Teacher.Tname = N’张三’<br>order by SC.score desc</p>
<p>–40.2 当最高分出现多个时<br>select Student.* , Course.Cname , SC.CID , SC.score<br>from Student, SC , Course , Teacher<br>where Student.SID = SC.SID and SC.CID = Course.CID and Course.TID = Teacher.TID and Teacher.Tname = N’张三’ and<br>SC.score = (select max(SC.score) from SC , Course , Teacher where SC.CID = Course.CID and Course.TID = Teacher.TID and Teacher.Tname = N’张三’)</p>
<p>–41、查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩<br>–方法1<br>select m.* from SC m ,(select CID , score from SC group by CID , score having count(1) &gt; 1) n<br>where m.CID= n.CID and m.score = n.score order by m.CID , m.score , m.SID</p>
<p>–方法2<br>select m.* from SC m where exists (select 1 from (select CID , score from SC group by CID , score having count(1) &gt; 1) n<br>where m.CID= n.CID and m.score = n.score) order by m.CID , m.score , m.SID</p>
<p>–42、查询每门功成绩最好的前两名<br>select t.* from sc t where score in (select top 2 score from sc where CID = T.CID order by score desc) order by t.CID , t.score desc</p>
<p>–43、统计每门课程的学生选修人数（超过5人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列<br>select Course.CID , Course.Cname , count(<em>) 学生人数<br>from Course , SC<br>where Course.CID = SC.CID<br>group by Course.CID , Course.Cname<br>having count(</em>) &gt;= 5<br>order by 学生人数 desc , Course.CID</p>
<p>–44、检索至少选修两门课程的学生学号<br>select student.SID , student.Sname<br>from student , SC<br>where student.SID = SC.SID<br>group by student.SID , student.Sname<br>having count(1) &gt;= 2<br>order by student.SID</p>
<p>–45、查询选修了全部课程的学生信息<br>–方法1 根据数量来完成<br>select student.* from student where SID in<br>(select SID from sc group by SID having count(1) = (select count(1) from course))</p>
<p>–方法2 使用双重否定来完成<br>select t.* from student t where t.SID not in<br>(<br>select distinct m.SID from<br>(<br>select SID , CID from student , course<br>) m where not exists (select 1 from sc n where n.SID = m.SID and n.CID = m.CID)<br>)</p>
<p>–方法3 使用双重否定来完成<br>select t.* from student t where not exists(select 1 from<br>(<br>select distinct m.SID from<br>(<br>select SID , CID from student , course<br>) m where not exists (select 1 from sc n where n.SID = m.SID and n.CID = m.CID)<br>) k where k.SID = t.SID<br>)</p>
<p>–46、查询各学生的年龄–46.1 只按照年份来算<br>select * , datediff(yy , sage , getdate()) 年龄 from student</p>
<p>–46.2 按照出生日期来算，当前月日 &lt; 出生年月的月日则，年龄减一<br>select * , case when right(convert(varchar(10),getdate(),120),5) &lt; right(convert(varchar(10),sage,120),5) then datediff(yy , sage , getdate()) - 1 else datediff(yy , sage , getdate()) end 年龄 from student</p>
<p>–47、查询本周过生日的学生<br>select * from student where datediff(week,datename(yy,getdate()) + right(convert(varchar(10),sage,120),6),getdate()) = 0</p>
<p>–48、查询下周过生日的学生<br>select * from student where datediff(week,datename(yy,getdate()) + right(convert(varchar(10),sage,120),6),getdate()) = -1</p>
<p>–49、查询本月过生日的学生<br>select * from student where datediff(mm,datename(yy,getdate()) + right(convert(varchar(10),sage,120),6),getdate()) = 0</p>
<p>–50、查询下月过生日的学生<br>select * from student where datediff(mm,datename(yy,getdate()) + right(convert(varchar(10),sage,120),6),getdate()) = -1</p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/08/11/linuxSoft/" rel="prev" title="linuxSoft">
      <i class="fa fa-chevron-left"></i> linuxSoft
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/08/11/python/" rel="next" title="python">
      python <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          المحتويات
        </li>
        <li class="sidebar-nav-overview">
          عام
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Jun-Gui</p>
  <div class="site-description" itemprop="description">总有疾风起</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">18</span>
          <span class="site-state-item-name">المقالات</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jun-Gui</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">مُجمل عدد الحروف: </span>
    <span title="مُجمل عدد الحروف">109k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">مُجمل زمن القراءة &asymp;</span>
    <span title="مُجمل زمن القراءة">1:39</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  
   <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
  
</body>
</html>
